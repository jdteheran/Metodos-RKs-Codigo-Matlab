function [x,y,xprima,yprima] = RKN_simple_DOPRI5_4_7_FM(a,b,n,x0,y0,xprima0,yprima0)
%EJEMPLO: [x,y,xprima,yprima] = RKN_simple_DOPRI5_4_7_FM(0,2.5,100,0,1,0,0);

format long;

h = (b-a)/n;
t = zeros(n,1);
x = zeros(n,1);
y = zeros(n,1);
xprima = zeros(n,1);
yprima = zeros(n,1);
KX1 = 0; KY1 = 0;
KX2 = 0; KY2 = 0;
KX3 = 0; KY3 = 0;
KX4 = 0; KY4 = 0;
KX5 = 0; KY5 = 0;
KX6 = 0; KY6 = 0;
KX7 = 0; KY7 = 0;

x(1,1) = x0;
y(1,1) = y0;
xprima(1,1) = xprima0;
yprima(1,1) = yprima0;
for i = 1:n-1
    t(i,1) = a + (i-1)*h;
    KX1 = f(t(i,1),x(i,1),y(i,1));
    KY1 = g(t(i,1),x(i,1),y(i,1));
    KX2 = f(t(i,1) + (1/5)*h,x(i,1) + (1/5)*h*xprima(i,1) + (1/5)*h^2*KX1,y(i,1) + (1/5)*h*yprima(i,1) + (1/5)*h^2*KY1);
    KY2 = g(t(i,1) + (1/5)*h,x(i,1) + (1/5)*h*xprima(i,1) + (1/5)*h^2*KX1,y(i,1) + (1/5)*h*yprima(i,1) + (1/5)*h^2*KY1);
    KX3 = f(t(i,1) + (3/10)*h,x(i,1) + (3/10)*h*xprima(i,1) + h^2*((3/40)*KX1 + (9/40)*KX2),y(i,1) + (3/10)*h*yprima(i,1) + h^2*((3/40)*KY1 + (9/40)*KY2));
    KY3 = g(t(i,1) + (3/10)*h,x(i,1) + (3/10)*h*xprima(i,1) + h^2*((3/40)*KX1 + (9/40)*KX2),y(i,1) + (3/10)*h*yprima(i,1) + h^2*((3/40)*KY1 + (9/40)*KY2));
    KX4 = f(t(i,1) + (4/5)*h,x(i,1) + (4/5)*h*xprima(i,1) + h^2*((44/45)*KX1 - (56/15)*KX2 + (32/9)*KX3),y(i,1) + (4/5)*h*yprima(i,1) + h^2*((44/45)*KY1 - (56/15)*KY2 + (32/9)*KY3));
    KY4 = g(t(i,1) + (4/5)*h,x(i,1) + (4/5)*h*xprima(i,1) + h^2*((44/45)*KX1 - (56/15)*KX2 + (32/9)*KX3),y(i,1) + (4/5)*h*yprima(i,1) + h^2*((44/45)*KY1 - (56/15)*KY2 + (32/9)*KY3));
    KX5 = f(t(i,1) + (8/9)*h,x(i,1) + (8/9)*h*xprima(i,1) + h^2*((19372/6561)*KX1 - (25360/2187)*KX2 + (64448/6561)*KX3 - (212/729)*KX4),y(i,1) + (8/9)*h*yprima(i,1) + h^2*((19372/6561)*KY1 - (25360/2187)*KY2 + (64448/6561)*KY3 - (212/729)*KY4));
    KY5 = g(t(i,1) + (8/9)*h,x(i,1) + (8/9)*h*xprima(i,1) + h^2*((19372/6561)*KX1 - (25360/2187)*KX2 + (64448/6561)*KX3 - (212/729)*KX4),y(i,1) + (8/9)*h*yprima(i,1) + h^2*((19372/6561)*KY1 - (25360/2187)*KY2 + (64448/6561)*KY3 - (212/729)*KY4));
    KX6 = f(t(i,1) + h,x(i,1) + h*xprima(i,1) + h^2*((9017/3168)*KX1 - (355/33)*KX2 + (46732/5247)*KX3 + (49/176)*KX4 - (5103/18656)*KX5),y(i,1) + h*yprima(i,1) + h^2*((9017/3168)*KY1 - (355/33)*KY2 + (46732/5247)*KY3 + (49/176)*KY4 - (5103/18656)*KY5));
    KY6 = g(t(i,1) + h,x(i,1) + h*xprima(i,1) + h^2*((9017/3168)*KX1 - (355/33)*KX2 + (46732/5247)*KX3 + (49/176)*KX4 - (5103/18656)*KX5),y(i,1) + h*yprima(i,1) + h^2*((9017/3168)*KY1 - (355/33)*KY2 + (46732/5247)*KY3 + (49/176)*KY4 - (5103/18656)*KY5));
    KX7 = f(t(i,1) + h,x(i,1) + h*xprima(i,1) + h^2*((35/384)*KX1 + (500/1113)*KX3 + (125/192)*KX4 - (2187/6784)*KX5 + (11/84)*KX6),y(i,1) + h*yprima(i,1) + h^2*((35/384)*KY1 + (500/1113)*KY3 + (125/192)*KY4 - (2187/6784)*KY5 + (11/84)*KY6));
    KY7 = g(t(i,1) + h,x(i,1) + h*xprima(i,1) + h^2*((35/384)*KX1 + (500/1113)*KX3 + (125/192)*KX4 - (2187/6784)*KX5 + (11/84)*KX6),y(i,1) + h*yprima(i,1) + h^2*((35/384)*KY1 + (500/1113)*KY3 + (125/192)*KY4 - (2187/6784)*KY5 + (11/84)*KY6));
    x(i+1,1) = x(i,1) + h*xprima(i,1) + h^2*((35/384)*KX1 + (500/1113)*KX3 + (125/192)*KX4 - (2187/6784)*KX5 + (11/84)*KX6);
    y(i+1,1) = y(i,1) + h*yprima(i,1) + h^2*((35/384)*KY1 + (500/1113)*KY3 + (125/192)*KY4 - (2187/6784)*KY5 + (11/84)*KY6);
    xprima(i+1,1) = xprima(i,1) + h*((5179/57600)*KX1 + (7571/16695)*KX3 + (393/640)*KX4 - (92097/339200)*KX5 + (187/2100)*KX6 + (1/40)*KX7);
    yprima(i+1,1) = yprima(i,1) + h*((5179/57600)*KY1 + (7571/16695)*KY3 + (393/640)*KY4 - (92097/339200)*KY5 + (187/2100)*KY6 + (1/40)*KY7);
end
t(n,1) = a + n*h;
plot(t,x,t,y);
%plot(t,xprima,t,yprima);
grid;
end